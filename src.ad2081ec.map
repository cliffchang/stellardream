{"version":3,"sources":["weightedChoice.ts","../node_modules/gaussian/lib/gaussian.js","stars.ts","../node_modules/alea/alea.js","planets.ts","starSystem.ts","index.ts"],"names":["exports","erfc","x","z","Math","abs","t","r","exp","Gaussian","mean","variance","Error","standardDeviation","sqrt","prototype","pdf","m","PI","e","pow","cdf","ppf","xx","log","j","err","ierfc","mul","d","scale","precision","dprecision","fromPrecisionMean","div","add","gaussian","sub","c","precisionmean"],"mappings":"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","file":"src.ad2081ec.map","sourceRoot":"../src","sourcesContent":["export default function weightedRandom<T>(weights: Array<[T, number]>, normalizedValue: number): T {\n  let sumOfWeights = 0;\n  for (let item of weights) {\n    sumOfWeights += item[1];\n  }\n\n  const randomValue: number = normalizedValue * sumOfWeights;\n \n  let sumSoFar = 0;\n  for (let [value, weight] of weights) {\n    sumSoFar += weight;\n    if (randomValue <= sumSoFar) {\n      return value;\n    }\n  }\n\n  throw new Error(\"Choice error: \" + randomValue);\n}","(function(exports) {\n\n  // Complementary error function\n  // From Numerical Recipes in C 2e p221\n  var erfc = function(x) {\n    var z = Math.abs(x);\n    var t = 1 / (1 + z / 2);\n    var r = t * Math.exp(-z * z - 1.26551223 + t * (1.00002368 +\n            t * (0.37409196 + t * (0.09678418 + t * (-0.18628806 +\n            t * (0.27886807 + t * (-1.13520398 + t * (1.48851587 +\n            t * (-0.82215223 + t * 0.17087277)))))))))\n    return x >= 0 ? r : 2 - r;\n  };\n\n  // Inverse complementary error function\n  // From Numerical Recipes 3e p265\n  var ierfc = function(x) {\n    if (x >= 2) { return -100; }\n    if (x <= 0) { return 100; }\n\n    var xx = (x < 1) ? x : 2 - x;\n    var t = Math.sqrt(-2 * Math.log(xx / 2));\n\n    var r = -0.70711 * ((2.30753 + t * 0.27061) /\n            (1 + t * (0.99229 + t * 0.04481)) - t);\n\n    for (var j = 0; j < 2; j++) {\n      var err = erfc(r) - xx;\n      r += err / (1.12837916709551257 * Math.exp(-(r * r)) - r * err);\n    }\n\n    return (x < 1) ? r : -r;\n  };\n\n  // Models the normal distribution\n  var Gaussian = function(mean, variance) {\n    if (variance <= 0) {\n      throw new Error('Variance must be > 0 (but was ' + variance + ')');\n    }\n    this.mean = mean;\n    this.variance = variance;\n    this.standardDeviation = Math.sqrt(variance);\n  }\n\n  // Probability density function\n  Gaussian.prototype.pdf = function(x) {\n    var m = this.standardDeviation * Math.sqrt(2 * Math.PI);\n    var e = Math.exp(-Math.pow(x - this.mean, 2) / (2 * this.variance));\n    return e / m;\n  };\n\n  // Cumulative density function\n  Gaussian.prototype.cdf = function(x) {\n    return 0.5 * erfc(-(x - this.mean) / (this.standardDeviation * Math.sqrt(2)));\n  };\n\n  // Percent point function\n  Gaussian.prototype.ppf = function(x) {\n    return this.mean - this.standardDeviation * Math.sqrt(2) * ierfc(2 * x);\n  };\n\n  // Product distribution of this and d (scale for constant)\n  Gaussian.prototype.mul = function(d) {\n    if (typeof(d) === \"number\") {\n      return this.scale(d);\n    }\n    var precision = 1 / this.variance;\n    var dprecision = 1 / d.variance;\n    return fromPrecisionMean(\n        precision + dprecision, \n        precision * this.mean + dprecision * d.mean);\n  };\n\n  // Quotient distribution of this and d (scale for constant)\n  Gaussian.prototype.div = function(d) {\n    if (typeof(d) === \"number\") {\n      return this.scale(1 / d);\n    }\n    var precision = 1 / this.variance;\n    var dprecision = 1 / d.variance;\n    return fromPrecisionMean(\n        precision - dprecision, \n        precision * this.mean - dprecision * d.mean);\n  };\n\n  // Addition of this and d\n  Gaussian.prototype.add = function(d) {\n    return gaussian(this.mean + d.mean, this.variance + d.variance);\n  };\n\n  // Subtraction of this and d\n  Gaussian.prototype.sub = function(d) {\n    return gaussian(this.mean - d.mean, this.variance + d.variance);\n  };\n\n  // Scale this by constant c\n  Gaussian.prototype.scale = function(c) {\n    return gaussian(this.mean * c, this.variance * c * c);\n  };\n\n  var gaussian = function(mean, variance) {\n    return new Gaussian(mean, variance);\n  };\n\n  var fromPrecisionMean = function(precision, precisionmean) {\n    return gaussian(precisionmean / precision, 1 / precision);\n  };\n\n  exports(gaussian);\n})\n(typeof(exports) !== \"undefined\"\n    ? function(e) { module.exports = e; }\n    : function(e) { this[\"gaussian\"] = e; });\n","import weightedChoice from \"./weightedChoice\";\nimport gaussian from \"gaussian\";\n\nfunction normalizedToRange(min: number, max: number, val: number): number {\n  return min + (max - min) * val;\n}\n\n/* STARS */\n\nexport enum StarType {\n  /* Planets in HZ will be tidally locked very quickly, but about half of\n     all M dwarfs will have a planet in the HZ\n   */\n  M = \"M\",\n  /* Starting to look good. Kepler searches star types K-F.\n   */\n  K = \"K\",\n  G = \"G\", // the sun is a G2\n  F = \"F\",\n  /* Stars age too quickly - only support life for about 2 billion years. Life may\n     be microbial, but likely no trees.\n   */\n  A = \"A\",\n  B = \"B\",\n  /*\n  Planetary dust disks located within 1.6 light-years of O-type stars are\n  likely to be \"boiled off\" by superhot radiation and winds\n  (therefore O-type stars likely won't have planets)\n  */\n  O = \"O\"  \n}\n\n// http://lup.lub.lu.se/luur/download?func=downloadFile&recordOId=8867455&fileOId=8870454\nexport const StarTypeProbabilities = new Map<StarType, number>([\n  [StarType.M, 0.7645629],\n  [StarType.K, 0.1213592],\n  [StarType.G, 0.0764563],\n  [StarType.F, 0.0303398],\n  [StarType.A, 0.0060679],\n  [StarType.B, 0.0012136],\n  [StarType.O, 0.0000003],\n]);\n\nexport const StarTemperature = new Map<StarType, number>([\n  [StarType.M, 3850],\n  [StarType.K, 5300],\n  [StarType.G, 5920],\n  [StarType.F, 7240],\n  [StarType.A, 9500],\n  [StarType.B, 31000],\n  [StarType.O, 41000],\n]);\n\nexport const StarLuminosityMin = new Map<StarType, number>([\n  [StarType.M, 0.000158],\n  [StarType.K, 0.086],\n  [StarType.G, 0.58],\n  [StarType.F, 1.54],\n  [StarType.A, 4.42],\n  [StarType.B, 21.2],\n  [StarType.O, 26800],\n]);\n\nexport const StarLuminosityMax = new Map<StarType, number>([\n  [StarType.M, 0.086],\n  [StarType.K, 0.58],\n  [StarType.G, 1.54],\n  [StarType.F, 4.42],\n  [StarType.A, 21.2],\n  [StarType.B, 26800],\n  [StarType.O, 78100000],\n]);\n\nexport const StarRadiusMin = new Map<StarType, number>([\n  [StarType.M, 0.08],\n  [StarType.K, 0.7],\n  [StarType.G, 0.96],\n  [StarType.F, 1.15],\n  [StarType.A, 1.4],\n  [StarType.B, 1.8],\n  [StarType.O, 6.6],\n]);\n\nexport const StarRadiusMax = new Map<StarType, number>([\n  [StarType.M, 0.7],\n  [StarType.K, 0.96],\n  [StarType.G, 1.15],\n  [StarType.F, 1.4],\n  [StarType.A, 1.8],\n  [StarType.B, 6.6],\n  [StarType.O, 12],\n]);\n\n\n// http://www.vendian.org/mncharity/dir3/starcolor/\nexport const StarColors = new Map<StarType, string>([\n  [StarType.O, '#9bb0ff'],\n  [StarType.B, '#aabfff'],\n  [StarType.A, '#cad7ff'],\n  [StarType.F, '#f8f7ff'],\n  [StarType.G, '#fff4ea'],\n  [StarType.K, '#ffd2a1'],\n  [StarType.M, '#ffcc6f'],\n]);\n\n// http://www.solstation.com/habitable.htm\n/**\n* ~44% of F6-K3 stars with 0.5-1.5 stellar masses are likely binary/multiple star systems,\n* making stable orbits extremely unlikely unless the stars are close together.\n* \n* Inside HZ: \"water is broken up by stellar radiation into oxygen and hydrogen...\n* the freed hydrogen would escape to space due to the relatively puny\n* gravitational pull of small rocky planets like Earth\"\n* \n* Outside HZ: \"atmospheric carbon dioxide condenses...which eliminates its\n* greenhouse warming effect.\"\n* \n* Stars get brighter as they age, so HZ expands outward. CHZ = \"continuously habitable zone\"\n* over time.\n*/\nexport const HabitableZonePlanetLikelihoods = new Map<StarType, number>([\n  [StarType.M, 0.0002],\n  [StarType.K, 0.001],\n  [StarType.G, 0.002],\n  [StarType.F, 0.001],\n  // my sources don't discuss these star types, and they are rare, so just pick\n  // some random small values\n  [StarType.A, 0.0002],\n  [StarType.B, 0.00015],\n  [StarType.O, 0.0001],\n]);\n\n// \"normalized solar flux factor\"\n// http://www.solstation.com/habitable.htm\nconst SeffInner = new Map<StarType, number>([\n  [StarType.M, 1.05],\n  [StarType.K, 1.05],\n  [StarType.G, 1.41],\n  [StarType.F, 1.9],\n  [StarType.A, 0],\n  [StarType.B, 0],\n  [StarType.O, 0],\n]);\n\nconst SeffOuter = new Map<StarType, number>([\n  [StarType.M, 0.27],\n  [StarType.K, 0.27],\n  [StarType.G, 0.36],\n  [StarType.F, 0.46],\n  [StarType.A, 0],\n  [StarType.B, 0],\n  [StarType.O, 0],\n]);\n\nfunction computeHabitableZoneHelper(luminosity: number, seff: number): number {\n  return 1 * Math.pow(luminosity / seff, 0.5);\n}\n\nexport function computeHabitableZone(t: StarType, luminosity: number): [number, number] {\n  return [\n      computeHabitableZoneHelper(luminosity, SeffInner.get(t)!),\n      computeHabitableZoneHelper(luminosity, SeffOuter.get(t)!)]\n}\n\nexport function computeMass(luminosity: number): number {\n  // https://en.wikipedia.org/wiki/Mass%E2%80%93luminosity_relation\n  // and also \n  // http://lup.lub.lu.se/luur/download?func=downloadFile&recordOId=8867455&fileOId=8870454\n  let a = 0.23;\n  let b = 2.3;\n  if (luminosity > 0.03) {\n    a = 1;\n    b = 4;\n  }\n  if (luminosity > 16) {\n    a = 1.5;\n    b = 3.5;\n  }\n  if (luminosity > 54) {\n    a = 3200;\n    b = 1;\n  }\n  return Math.pow(luminosity / a, b);\n}\n\n/*\n// this is garbage and wrong, don't use this\n// might be able to salvage using this:\n// https://www.astro.princeton.edu/~gk/A403/constants.pdf\nexport function computeRadius(t: StarType, luminosity: number): number {\n  const temperature = StarTemperature.get(t)!;\n  const tempRatio = temperature / StarTemperature.get(StarType.G)!\n\n  return Math.sqrt(Math.pow(tempRatio, 4) / luminosity);\n}\n*/\n\n/*\n  https://arxiv.org/pdf/1511.07438.pdf\n  \n  According to this paper, metallicity distribution is best represented\n  by a combination of two Gaussians.\n\n  Units are in [Fe/H], which you should google. It's a measure of the\n  presence of iron vs the solar system on a logarithmic scale.\n*/\nexport function getMetallicityValue(aRandomNumber: number, n2: number): number {\n  const dist1 = gaussian(0.3, 0.1);\n  const dist2 = gaussian(-0.45, 0.1);\n  const val1 = dist1.ppf(aRandomNumber);\n  const val2 = dist2.ppf(aRandomNumber);\n  // According to stats.stackexchange.com there's a super mathy way to\n  // combine two Gaussian distributions, but using a weighted choice\n  // seems to produce similar results, so whatever.\n  return weightedChoice([[val1, 1.5], [val2, 0.5]], n2);\n}\n\nexport class Star {\n    starType: StarType;\n    luminosity: number;\n    mass: number;\n    radius: number;\n    color: string;\n    metallicity: number;\n\n    // _metallicity?: number;\n    // _metallicityValues: [number, number];\n\n    constructor(getRandom: any) {\n        let weights = Array<[StarType, number]>();\n        StarTypeProbabilities.forEach((v: number, k: StarType) => {\n          weights.push([k, v]);\n        });\n        this.starType = weightedChoice(weights, getRandom());\n        this.color = StarColors.get(this.starType)!;\n\n        const sizeValue = getRandom();\n        this.luminosity = normalizedToRange(\n          StarLuminosityMin.get(this.starType)!,\n          StarLuminosityMax.get(this.starType)!,\n          sizeValue);\n        this.radius = normalizedToRange(\n          StarRadiusMin.get(this.starType)!,\n          StarRadiusMax.get(this.starType)!,\n          sizeValue);\n        this.mass = computeMass(this.luminosity);\n\n        // this._metallicity = undefined;\n        // this._metallicityValues = [getRandom(), getRandom()];\n        this.metallicity = getMetallicityValue(getRandom(), getRandom());\n    }\n\n    // get metallicity(): number {\n    //   // this is expensive, so compute it lazily\n    //   if (this._metallicity === null) {\n    //     this._metallicity = getMetallicityValue(this._metallicityValues[0], this._metallicityValues[1]);\n    //   }\n    //   return this._metallicity!;\n    // }\n}","(function (root, factory) {\n  if (typeof exports === 'object') {\n      module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n      define(factory);\n  } else {\n      root.Alea = factory();\n  }\n}(this, function () {\n\n  'use strict';\n\n  // From http://baagoe.com/en/RandomMusings/javascript/\n\n  // importState to sync generator states\n  Alea.importState = function(i){\n    var random = new Alea();\n    random.importState(i);\n    return random;\n  };\n\n  return Alea;\n\n  function Alea() {\n    return (function(args) {\n      // Johannes Baagøe <baagoe@baagoe.com>, 2010\n      var s0 = 0;\n      var s1 = 0;\n      var s2 = 0;\n      var c = 1;\n\n      if (args.length == 0) {\n        args = [+new Date];\n      }\n      var mash = Mash();\n      s0 = mash(' ');\n      s1 = mash(' ');\n      s2 = mash(' ');\n\n      for (var i = 0; i < args.length; i++) {\n        s0 -= mash(args[i]);\n        if (s0 < 0) {\n          s0 += 1;\n        }\n        s1 -= mash(args[i]);\n        if (s1 < 0) {\n          s1 += 1;\n        }\n        s2 -= mash(args[i]);\n        if (s2 < 0) {\n          s2 += 1;\n        }\n      }\n      mash = null;\n\n      var random = function() {\n        var t = 2091639 * s0 + c * 2.3283064365386963e-10; // 2^-32\n        s0 = s1;\n        s1 = s2;\n        return s2 = t - (c = t | 0);\n      };\n      random.uint32 = function() {\n        return random() * 0x100000000; // 2^32\n      };\n      random.fract53 = function() {\n        return random() + \n          (random() * 0x200000 | 0) * 1.1102230246251565e-16; // 2^-53\n      };\n      random.version = 'Alea 0.9';\n      random.args = args;\n\n      // my own additions to sync state between two generators\n      random.exportState = function(){\n        return [s0, s1, s2, c];\n      };\n      random.importState = function(i){\n        s0 = +i[0] || 0;\n        s1 = +i[1] || 0;\n        s2 = +i[2] || 0;\n        c = +i[3] || 0;\n      };\n \n      return random;\n\n    } (Array.prototype.slice.call(arguments)));\n  }\n\n  function Mash() {\n    var n = 0xefc8249d;\n\n    var mash = function(data) {\n      data = data.toString();\n      for (var i = 0; i < data.length; i++) {\n        n += data.charCodeAt(i);\n        var h = 0.02519603282416938 * n;\n        n = h >>> 0;\n        h -= n;\n        h *= n;\n        n = h >>> 0;\n        h -= n;\n        n += h * 0x100000000; // 2^32\n      }\n      return (n >>> 0) * 2.3283064365386963e-10; // 2^-32\n    };\n\n    mash.version = 'Mash 0.9';\n    return mash;\n  }\n}));\n","import { Star } from \"./stars\";\n\nexport enum KeplerGrouping {\n    HotJupiter = \"HotJupiter\",\n    ColdGasGiant = \"ColdGasGiant\",\n    IceGiant = \"IceGiant\",\n    OceanWorld = \"OceanWorld\",\n    LavaWorld = \"LavaWorld\",\n    Rocky = \"Rocky\",\n}\n\n// https://medium.com/starts-with-a-bang/sorry-super-earth-fans-there-are-only-three-classes-of-planet-44f3da47eb64\nexport enum PlanetType {\n    Terran = \"Terran\",\n    Neptunian = \"Neptunian\",\n    Jovian = \"Jovian\",\n    Placeholder = \"Placeholder\",\n}\n\n// Units: 10^x earth-masses\n// https://arxiv.org/pdf/1603.08614v2.pdf%29\n/*\n    https://www.manyworlds.space/index.php/tag/hydrogen-and-helium-envelope/\n\n    \"...it appears that once a planet has a radius more than 1.5 or 1.6\n    times the size of Earth, it will most likely have a thick gas envelope of\n    hydrogen, helium and sometimes methane and ammonia around it.\"\n*/\nexport const PlanetTypeMassMin = new Map<PlanetType, number>([\n    [PlanetType.Terran, -1.3],      // ~mercury sized\n    [PlanetType.Neptunian, 0.22],   // ~1.6 earth masses\n    [PlanetType.Jovian, 2],\n]);\n\nexport const PlanetTypeMassMax = new Map<PlanetType, number>([\n    [PlanetType.Terran, 0.22],\n    [PlanetType.Neptunian, 2],\n    [PlanetType.Jovian, 3.5],\n]);\n\n// R = M^exponent\nexport const PlanetTypeRadiusExponent = new Map<PlanetType, number>([\n    [PlanetType.Terran, 0.28],\n    [PlanetType.Neptunian, 0.59],\n    [PlanetType.Jovian, -0.04],\n]);\n\nexport class Planet {\n    distance: number;\n    star: Star;\n    planetType: PlanetType;\n\n    constructor(\n        planetType: PlanetType,\n        star: Star,\n        distance: number)\n    {\n        this.planetType = planetType;\n        this.distance = distance;\n        this.star = star;\n    }\n}","import Alea from \"alea\";\n\nimport {Star, StarType, computeHabitableZone} from \"./stars\";\nimport {Planet, PlanetType} from \"./planets\";\nimport weightedRandom from \"./weightedChoice\";\n\nfunction normalizedToRange(min: number, max: number, val: number): number {\n  return min + (max - min) * val;\n}\n\nfunction shuffle<T>(a: Array<T>) {\n    for (let i = a.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a;\n}\n\n/*\n    http://www.solstation.com/habitable.htm\n\n    \"Thus far, no one theory has been able to make definitive predictions of the\n    frequency of planet formation nor of the distribution of planetary sizes and\n    orbits.\"\n\n    \"planetary systems may be more common around stars whose spectra show an\n    enriched abundance of elements heavier than hydrogen and helium -- also\n    called high 'metallicity'\"\n\n    \"Numerical modeling of the accumulation of planetesimals during molecular\n    cloud collapse have produced, on average, four rocky inner planets for models\n    similar to the Solar System. The results included two, roughly Earth-sized\n    planets and two smaller planets, where their orbital distance ranged between\n    that of Mercury (0.4 AU) and Mars (1.5 AU). Hence, some astronomers expect to\n    find rocky planets around other stars within that range of orbits.\"\n\n    \"NASA's Kepler Mission is defining the size of an Earth-type planet to be\n    those that have between 0.5 and 2.0 times Earth's mass, or those having\n    between 0.8 and 1.3 times Earth's radius or diameter. The mission will\n    also investigate larger terrestrial planets that have two to ten Earth\n    masses, or 1.3 to 2.2 times its radius/diameter. Larger planets, however,\n    will be excluded because they may have sufficient gravity to attract a\n    massive hydrogen-helium atmosphere like the gas giants. On the other\n    extreme, those planets -- like Mars or Mercury -- that have less than\n    half the Earth's mass and are located in or near their star's habitable\n    zone may lose their initial life-supporting atmosphere because of low\n    gravity and/or the lack of plate tectonics needed to recycle\n    heat-retaining carbon dioxide gas back into the atmosphere.\"\n\n*/\n\nexport function addPlanets(starSystem: StarSystem, getRandom: () => number) {\n    switch (starSystem.stars[0].starType) {\n    case (StarType.A):\n    case (StarType.B):\n    case (StarType.O):\n        // These behave differently so I'm skipping them for now.\n        // Planets may form at 100-1000au from the star, but will\n        // only be habitable for a few million years.\n        return;\n    }\n\n    if (getRandom() < 0.3) {\n        // Current research suggests that 70% of sunlike stars have terran\n        // or neptunian planets (see comment later). So in 30% of cases, just\n        // bail.\n        return;\n    }\n\n    const [hzMin, hzMax] = computeHabitableZone(\n        starSystem.stars[0].starType, starSystem.stars[0].luminosity);\n\n    // Stick a planet slot in the habitable zone because I don't have anything\n    // else to go on. Then add slots toward and away from the sun based on\n    // the Titus-Bode law:\n    // https://en.wikipedia.org/wiki/Titius%E2%80%93Bode_law\n    // According to this paper it's pretty darn accurate:\n    // https://watermark.silverchair.com/stt1357.pdf?token=AQECAHi208BE49Ooan9kkhW_Ercy7Dm3ZL_9Cf3qfKAc485ysgAAAkYwggJCBgkqhkiG9w0BBwagggIzMIICLwIBADCCAigGCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMXXlXIp7_lwD8QJsjAgEQgIIB-Z96njhcrt4HyhJSQ_02byW4uXVLfJlgORYjKns4IgHZ7hOohpgBhhuilHJ9CqVseHjZ2gRc6UxJ9zbWPMSEbR2ccKm93ziwbQIfl0cP7lLi50lTyffZyuW4klH9hF5usqCbX3mVLhrMVLaHRqpHY9ciTzJnLosk_FJJbYNV_OkvruGc0uY_6EtOkt13FZRxTG-Of3T9CfZj2L6PMTZxVTOMP-xY8TEDr20Kgxkwp-0DA9Lbec4SBgaEAMYSo8FJDHH_VZqYUE4H5BoUk3MRzaIbmGfCxttLGm96f-Pa0uYneyt6XZFXSUj9X7kAcN1wO0ul3pLBmhhY8dGYF_dFNKOnV3Q4O5yaFjtsJXrJheJh82UsyYmZo36QaZIC8c7h5fDluDz51JM-n_pdaI_Nj6DKXk1eisgd5wLj3MeZappwhTVDsRZnyfhLRkW6VWb0bm-FzcjEw6KvOZtJh9D7-jPyqc4Qnpdt5jLXyLqXJDOlUH1IYf0fJf1k_cw1jAPMHveHHEGrxwpZ1Jee7Q7gR1hZwkVBC4BzPq2K9a22SJ8Jgktr5PHi7RXSTeXVa9mlDTM8uqnXmwYdAu_y3SeyPvIJL7LZ7KKh_Z7FPqIwMjUHWDrY20FWHUl9oRlqthDT9CgEW1ECV9h6-MfEUlKMXUKf92FKxzICRlk\n\n    const planetAnchor = normalizedToRange(hzMin, hzMax, getRandom());\n    let planetSlots = [planetAnchor];\n    // Add 6 slots away from the star (solar system value + 1)\n    for (let i=0; i<5; i++) {\n        planetSlots.unshift(planetSlots[0] * normalizedToRange(1.1, 2, getRandom()));\n    }\n    // Add 4 slots close to the star (solar system value + 1)\n    for (let i=0; i<5; i++) {\n        planetSlots.push(planetSlots[planetSlots.length - 1] / normalizedToRange(1.1, 2, getRandom()));\n    }\n    // Remember original slots so we can add placeholder planets later on as markers\n    const originalSlots = planetSlots.map((i) => i);\n    planetSlots = shuffle(planetSlots);\n\n    /*\n        http://iopscience.iop.org/article/10.1086/428383/pdf\n        https://arxiv.org/pdf/1511.07438.pdf\n\n        \"One-quarter of the FGK-type stars with [Fe/H] > 0.3 dex harbor\n        Jupiter-like planets with orbital periods shorter than 4 yr. In\n        contrast, gas giant planets are detected around fewer than 3% of\n        the stars with subsolar metallicity. \"\n    */\n\n    /*\n    We can use that information to form a simple planet type distribution\n    strategy. If a star has high metallicity, we'll say gas giant probability\n    per plant is 30%; otherwise it'll be 6%.\n    */\n   const jovianWeight = starSystem.metallicity >= 0 ? 0.3 : 0.04;\n\n   // Eyeballed figures from https://www.popularmechanics.com/space/deep-space/a13733860/all-the-exoplanets-weve-discovered-in-one-small-chart/\n   const terrainWeight = 0.3;\n   const neptunianWeight = 0.6;\n\n    const hzSlots = planetSlots.filter((dist) => dist > hzMin && dist < hzMax);\n    const hotSlots = planetSlots.filter((dist) => dist <= hzMin);\n    const coldSlots = planetSlots.filter((dist) => dist >= hzMax);\n\n    /*\n\n        https://www.nasa.gov/mission_pages/kepler/news/17-percent-of-stars-have-earth-size-planets.html\n\n        \"Extrapolating from Kepler's currently ongoing observations and results\n        from other detection techniques, scientists have determined that nearly\n        all sun-like stars have planets.\"\n\n    */\n\n    /*\n        https://www.cfa.harvard.edu/news/2013-01\n\n        \"Altogether, the researchers found that 50 percent of stars have a\n        planet of Earth-size or larger in a close orbit. By adding larger\n        planets, which have been detected in wider orbits up to the orbital\n        distance of the Earth, this number reaches 70 percent.\"\n\n        \"for every planet size except gas giants, the type of star doesn't\n        matter.\"\n    */\n        \n    /*\n        http://www.pnas.org/content/111/35/12647\n\n        \"The HZ of M-type dwarfs corresponds to orbital periods of a few weeks\n        to a few months. Kepler’s current planet catalog is sufficient for\n        addressing statistics of HZ exoplanets orbiting M stars. The results\n        indicate that the average number of small (0.5–1.4 R⊕) HZ\n        (optimistic) planets per M-type main-sequence star is ∼0.5.\"\n\n        \"Collectively, the statistics emerging from the Kepler data suggest\n        that every late-type main-sequence star has at least one planet (of\n        any size), that one in six has an Earth-size planet within a\n        Mercury-like orbit, and that small HZ planets around M dwarfs abound.\"\n    */\n\n    /*\n    The way that all gets captured here is to just pick random planet slots\n    and put planets in them.\n\n    ~50% of planet slots are \"close\" orbits (HZ or closer), which captures\n    the M-type data pretty well, and since other star types have habitable\n    zones farther out, that will naturally push all the planet slots outward\n    as well.\n    */\n\n    const planetTypeChoices: Array<[PlanetType, number]> = [\n        [PlanetType.Terran, terrainWeight],\n        [PlanetType.Neptunian, neptunianWeight],\n        [PlanetType.Jovian, jovianWeight],\n    ]\n\n    // As mentioned earlier, half of dwarf stars have a Terran planet\n    // in their HZs. For other stars, just do something random.\n    if (starSystem.stars[0].starType == StarType.M) {\n        starSystem.planets.push(new Planet(\n            weightedRandom(planetTypeChoices, getRandom()),\n            starSystem.stars[0],\n            hzSlots.pop()!));\n        planetSlots = hzSlots.concat(hotSlots).concat(coldSlots);\n    } else {\n        starSystem.planets.push(new Planet(\n            weightedRandom(planetTypeChoices, getRandom()),\n            starSystem.stars[0],\n            planetSlots.pop()!));\n    }\n\n    // https://www.nasa.gov/image-feature/ames/planetary-systems-by-number-of-known-planets\n    // Just eyeballing the graph, and with the assumption that many exoplanets\n    // are not yet discovered in known systems, let's say that there's a 30% chance\n    // of continuing our planet-adding loop each time.\n    // And FYI, it's totally fine to have 2+ gas giants in a system. This paper\n    // describes one with SIX: https://arxiv.org/pdf/1710.07337.pdf\n    while (planetSlots.length > 0 && getRandom() < 0.3) {\n        starSystem.planets.push(new Planet(\n            weightedRandom(planetTypeChoices, getRandom()),\n            starSystem.stars[0],\n            planetSlots.pop()!));\n    }\n\n    // for (let s of originalSlots) {\n    //     starSystem.planets.push(new Planet(\n    //         PlanetType.Placeholder, starSystem.stars[0], s));\n    // }\n}\n\nexport class StarSystem {\n    seed: number;\n    stars: Array<Star>;\n    planets: Array<Planet>;\n    // metallicity: number;\n\n    constructor(seed: number) {\n        this.seed = seed;\n\n        const alea = new (Alea as any)(seed);\n\n        this.stars = [new Star(alea)];\n        // this.metallicity = this.stars[0].metallicity;\n        \n        /*\n          Roughly 44% of star systems have two stars. The stars orbit each\n          other at distances of \"zero-ish\" to 1 light year. Alpha Centauri,\n          for example, has Proxima Centauri at 15,000 AU (~0.23 light years).\n\n          This model will only look at \"close binaries\" (hand-wavingly\n          estimated at half of binary systems), and say their planets are in\n          orbit of both stars simultaneously. Other binaries will be treated\n          like separate star systems. Research shows that even non-close\n          binaries make planetary orbits eccentric over time (billions of\n          years), but this would have no effect on colonization potential by\n          humans (I suppose) except as it relates to the development of\n          human-relevant life.\n         */\n        if (alea() > 0.22) {\n            this.stars.push(new Star(alea));\n            // this.metallicity = Math.max(this.metallicity, this.stars[1].metallicity);\n\n            // One strategy for generating the second star would be to force\n            // it to be smaller than the first, but it's simpler to just\n            // generate them independently and sort by mass.\n            this.stars = this.stars.sort((a, b) => {\n                return b.mass - a.mass;\n            });\n        }\n\n        this.planets = [];\n        addPlanets(this, alea);\n    }\n\n    get metallicity(): number {\n        let metallicity: number = this.stars[0].metallicity;\n        for (let s of this.stars) {\n            metallicity = Math.max(metallicity, s.metallicity);\n        }\n        return metallicity;\n    }\n}","import {\n    StarTypeProbabilities,\n    StarType,\n    HabitableZonePlanetLikelihoods,\n    computeHabitableZone,\n    getMetallicityValue,\n} from \"./stars\";\nimport {StarSystem} from \"./starSystem\";\n\n/// Tweak probability values to make planets more habitable and life-infested\nfunction cheatStars() {\n    StarTypeProbabilities.set(StarType.K, StarTypeProbabilities.get(StarType.K)! + 0.5);\n    StarTypeProbabilities.set(StarType.G, StarTypeProbabilities.get(StarType.G)! + 0.5);\n    StarTypeProbabilities.set(StarType.F, StarTypeProbabilities.get(StarType.F)! + 0.5);\n\n    // Cheat so about half of G-type stars have a planet in their habitable zones\n    for (let k of Object.keys(StarType)) {\n        const t = StarType[k as keyof typeof StarType];\n        HabitableZonePlanetLikelihoods.set(t, HabitableZonePlanetLikelihoods.get(t)! * 250);\n    }\n}\n// cheatStars();\n\n// main\nconst main = document.getElementById(\"js-main\");\nconst seed = Date.now();\n\nif (main) {\n    main.innerHTML = '';\n    for (let i=0; i<102; i++) {\n        const system = new StarSystem(seed + i);\n\n        const systemEl = document.createElement('div');\n        systemEl.className = 'system';\n\n        for (let star of system.stars) {\n            const starEl = document.createElement('div');\n            systemEl.appendChild(starEl);\n            starEl.className = 'star';\n            starEl.style.backgroundColor = star.color;\n            starEl.innerHTML = star.starType == StarType.M ? \"\" : star.starType;\n            starEl.title = JSON.stringify(star, null, 2);\n\n            const minStarSize = 0.08;\n            const minPixelSize = 3;\n            const w = minPixelSize / minStarSize * star.radius;\n            starEl.style.width = w.toString() + 'px';\n            starEl.style.height = w.toString() + 'px';\n            starEl.style.borderRadius = (w / 2).toString() + 'px';\n\n            // console.table(system.stars[0]);\n        }\n\n        const separatorEl = document.createElement('div');\n        systemEl.appendChild(separatorEl);\n        separatorEl.className = 'planet-separator';\n\n        const planetsEl = document.createElement('div');\n        systemEl.appendChild(planetsEl);\n        planetsEl.className = 'planets-container';\n\n        const distanceFactor = 50;\n\n        const hzEl = document.createElement('div');\n        planetsEl.appendChild(hzEl);\n        hzEl.className = 'hz-indicator';\n        const [hzMin, hzMax] = computeHabitableZone(system.stars[0].starType, system.stars[0].luminosity);\n        hzEl.style.left = hzMin * distanceFactor + \"px\";\n        hzEl.style.width = (hzMax - hzMin) * distanceFactor + \"px\";\n\n        let maxDistance = 1;\n        for (let planet of system.planets) {\n            const planetEl = document.createElement('div');\n            planetsEl.appendChild(planetEl);\n            planetEl.className = \"planet-\" + planet.planetType.toString().toLowerCase();\n            planetEl.style.position = 'absolute';\n            planetEl.style.left = planet.distance * distanceFactor + \"px\";\n            planetEl.title = JSON.stringify(planet, null, 2);\n            maxDistance = Math.max(maxDistance, planet.distance);\n\n            planetsEl.style.backgroundColor = 'lightblue';\n        }\n        planetsEl.style.width = (maxDistance * distanceFactor) + 100 + \"px\";\n\n        main.appendChild(systemEl);\n    }\n}\n\n// Dumb visual check of the metallicity probability distribution\nfunction testMetallicity() {\n    if (document.body.children[0].tagName == 'CANVAS') {\n        document.body.removeChild(document.body.children[0]);\n    }\n\n    const buckets: any = {};\n    let maxCount = 0;\n    let min = 0;\n    let max = 0;\n    const mult = 100;\n    for(let i=0; i<100000; i++) {\n        const val = getMetallicityValue(Math.random(), Math.random());\n        const roundedVal = Math.floor(val * mult) / mult;\n        min = Math.min(min, roundedVal);\n        max = Math.max(max, roundedVal);\n        if (!buckets[roundedVal]) buckets[roundedVal] = 0;\n        buckets[roundedVal] += 1;\n        maxCount = Math.max(maxCount, buckets[roundedVal]);\n    }\n    console.log(maxCount);\n\n    const height = 200;\n    const factor = height / maxCount;\n\n    const canvasEl = document.createElement('canvas');\n    canvasEl.width = (max - min) * mult;\n    canvasEl.height = height;\n    canvasEl.style.backgroundColor = 'white';\n    const ctx = canvasEl.getContext('2d');\n    if (!ctx) return;\n\n    ctx.fillStyle = 'black';\n\n    for(let i=min * mult; i<max * mult; i+=1) {\n        const k = i / mult;\n        const val = buckets[k];\n\n        switch (k) {\n        case 0:\n            ctx.fillStyle = 'red';\n            break;\n        case 0.3:\n        case -0.45:\n            ctx.fillStyle = 'lightgreen';\n            break;\n        case 1:\n            ctx.fillStyle = 'cyan';\n            break;\n        case -1:\n            ctx.fillStyle = 'yellow';\n            break;\n        default:\n            ctx.fillStyle = 'black';\n            break;\n        }\n        ctx.fillRect(i - (min * mult), height - val * factor, 1, val * factor);\n    }\n    console.log(buckets);\n\n    document.body.insertBefore(canvasEl, document.body.children[0]);\n}\n// testMetallicity();"]}